<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>RICHARD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Technology Blog">
<meta name="keywords" content="Python, JS, Vue, NodeJS">
<meta property="og:type" content="website">
<meta property="og:title" content="RICHARD">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="RICHARD">
<meta property="og:description" content="Technology Blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RICHARD">
<meta name="twitter:description" content="Technology Blog">
  
    <link rel="alternate" href="/atom.xml" title="RICHARD" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">RICHARD</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">RICHARD BLOG</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Vuex状态管理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/21/Vuex状态管理/" class="article-date">
  <time datetime="2019-10-21T01:49:37.000Z" itemprop="datePublished">2019-10-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/21/Vuex状态管理/">Vuex状态管理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Vuex 是一个专为Vue.js应用开发的状态管理模式,集中式存储管理应用所有组件的状态.<br>Vuex遵循”单向数据流”理念,易于问题追踪以及提高代码可维护性.</p>
<h2 id="安装-vuex"><a href="#安装-vuex" class="headerlink" title="安装 vuex"></a>安装 vuex</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue add vuex</span><br></pre></td></tr></table></figure>

<h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><ul>
<li>state 状态，数据</li>
<li>mutations更改状态的函数</li>
<li>actions异步操作</li>
<li>store包含以上概念的容器</li>
</ul>
<h2 id="状态和状态变更"><a href="#状态和状态变更" class="headerlink" title="状态和状态变更"></a>状态和状态变更</h2><p>通常 Vuex的内容写成模块化的方式: /src/vuex/modules /src/vuex/store.js</p>
<ol>
<li>新建一个文件夹vuex</li>
<li>vuex 文件夹下 新建一个文件夹modules,用来存放一个个单独的store配置文件</li>
<li>vuex 文件夹下 新建 store.js, 用于创建Vuex.Store实例.</li>
</ol>
<ul>
<li><p>在modules文件夹下新建 add.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// state保存数据状态</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">    count: <span class="number">0</span>,</span><br><span class="line">    left: <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// mutations用于修改状态</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    increment(state) &#123;</span><br><span class="line">        state.count += <span class="number">1</span></span><br><span class="line">        state.left -= <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 从state派生出新状态,类似计算属性</span></span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">    getCount(state) &#123;</span><br><span class="line">        <span class="keyword">return</span> state.count</span><br><span class="line">    &#125;,</span><br><span class="line">    left(state) &#123;</span><br><span class="line">        <span class="keyword">return</span> state.left</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 动作- actions</span></span><br><span class="line"><span class="comment">// 复杂业务逻辑 或者 调用api请求服务器 获取数据,然后通过commmit保存到state.</span></span><br><span class="line"><span class="comment">// actions内部函数执行同步代码返回的结果依然是promise</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    asyncAdd(&#123;commit&#125;)&#123;</span><br><span class="line">        commit(<span class="string">"increment"</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    increment(&#123;getters, commit&#125;) &#123;</span><br><span class="line">        <span class="comment">// 添加业务逻辑</span></span><br><span class="line">        <span class="keyword">if</span> (getters.left &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            commit(<span class="string">"increment"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    asyncIncrement(&#123; dispatch &#125;) &#123;</span><br><span class="line">        <span class="comment">// 异步逻辑返回Promise</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                resolve(dispatch(<span class="string">"increment"</span>))</span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 将整个对象返回</span></span><br><span class="line"><span class="comment">// namespaced 使用命名空间</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    namespaced: <span class="literal">true</span>,</span><br><span class="line">    state,</span><br><span class="line">    getters,</span><br><span class="line">    actions,</span><br><span class="line">    mutations</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>store.js</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"><span class="keyword">import</span> add <span class="keyword">from</span> <span class="string">'./modules/add.js'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"><span class="comment">// 以模块的方式 写入</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line"> modules: &#123;</span><br><span class="line">   add: add</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>main.js </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./vuex/store.js'</span></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>在组件中使用store中的state, commit, dispatch, getters</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"home"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>手榴弹扔了&#123;&#123; $store.state.add.count &#125;&#125; 个<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"add"</span>&gt;</span>扔一个<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"asyncAdd"</span>&gt;</span>蓄力扔一个<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">'home'</span>,</span></span><br><span class="line">  methods: &#123;</span><br><span class="line">    add() &#123;</span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.$store.commit(<span class="string">"add/increment"</span>)</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 即使action执行同步代码返回的结果依然是Promsie对象</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// this.$store.dispatch("add/increment").then(res =&gt; &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   if (!res) &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     alert("投掷失败! 没货了")</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   &#125;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// &#125;)</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    asyncAdd() &#123;</span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.$store.dispatch(<span class="string">"add/asyncAdd"</span>)</span></span><br><span class="line"><span class="javascript">      <span class="comment">// this.$store.dispatch("add/asyncIncrement").then(res =&gt; &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   if (!res) &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     alert("投掷失败! 没货了")</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   &#125;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// &#125;)</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="实现自己的Vuex"><a href="#实现自己的Vuex" class="headerlink" title="实现自己的Vuex"></a>实现自己的Vuex</h2><p>实现Store类</p>
<ol>
<li>state响应化处理</li>
<li>保存状态，实现dispatch，commit，getters<br>实现插件</li>
<li>挂载store实例</li>
</ol>
<ul>
<li><p>创建 zvuex.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义vuex</span></span><br><span class="line"><span class="comment">// vuex 内最重要的是实现两个方法commit 方法和 dispatch方法</span></span><br><span class="line"><span class="comment">// 1. 插件</span></span><br><span class="line"><span class="keyword">let</span> Vue</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params">_Vue</span>) </span>&#123;</span><br><span class="line">    Vue = _Vue</span><br><span class="line">    <span class="comment">// 混入 store, 混入的作用: 让它至少会执行一次</span></span><br><span class="line">    <span class="comment">// store 执行的时候就有Vue,不用import</span></span><br><span class="line">    <span class="comment">// 这也是为什么Vue.use必须在新建store之前</span></span><br><span class="line">    Vue.mixin(&#123;</span><br><span class="line">        beforeCreate() &#123;</span><br><span class="line">            <span class="comment">// 这样才能获取到传递进来的store</span></span><br><span class="line">            <span class="comment">// 只有root元素才有store, 所以判断一下</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.$options.store) &#123;</span><br><span class="line">                Vue.prototype.$store = <span class="keyword">this</span>.$options.store</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2. 实现Store</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(options = &#123;&#125;) &#123;</span><br><span class="line">        <span class="keyword">this</span>.state = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">            data: options.state</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">this</span>.mutations = options.mutations || &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.actions = options.actions || &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// func 是mutations中的函数名</span></span><br><span class="line">    <span class="comment">// 注意这里用箭头函数形式, 后面actions实现时会有作用</span></span><br><span class="line">    commit = <span class="function">(<span class="params">func, arg</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.mutations[func](<span class="keyword">this</span>.state, arg)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dispatch(func, arg) &#123;</span><br><span class="line">        <span class="keyword">this</span>.actions[func](&#123;</span><br><span class="line">            commit: <span class="keyword">this</span>.commit,</span><br><span class="line">            state: <span class="keyword">this</span>.state,</span><br><span class="line">        &#125;, arg)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; Store, install &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用自定义的vuex</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用自定义的vuex</span></span><br><span class="line"><span class="comment">// 这个文件 其实就是一个 配置文件的东西, 将一个对象作为参数传入Vuex的Store类中,创建一个Store实例.</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Zvuex <span class="keyword">from</span> <span class="string">'./zvuex.js'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Zvuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Zvuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        count: <span class="number">0</span>,</span><br><span class="line">        left: <span class="number">10</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mutations: &#123;</span><br><span class="line">        increment(state) &#123;</span><br><span class="line">            state.count += <span class="number">1</span></span><br><span class="line">            state.left -= <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    getters: &#123;</span><br><span class="line">        getCount(state) &#123;</span><br><span class="line">            <span class="keyword">return</span> state.count</span><br><span class="line">        &#125;,</span><br><span class="line">        left(state) &#123;</span><br><span class="line">            <span class="keyword">return</span> state.left</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    actions: &#123;</span><br><span class="line">        asyncAdd(&#123;commit&#125;)&#123;</span><br><span class="line">            commit(<span class="string">"increment"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        increment(&#123;getters, commit&#125;) &#123;</span><br><span class="line">            <span class="comment">// 添加业务逻辑</span></span><br><span class="line">            <span class="keyword">if</span> (getters.left &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                commit(<span class="string">"increment"</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line">        asyncIncrement(&#123; dispatch &#125;) &#123;</span><br><span class="line">            <span class="comment">// 异步逻辑返回Promise</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">                setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// 使用其他的 action</span></span><br><span class="line">                    resolve(dispatch(<span class="string">"increment"</span>))</span><br><span class="line">                &#125;, <span class="number">1000</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>main.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="comment">// 导入自己的store配置文件</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./zstore.js'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/21/Vuex状态管理/" data-id="ckh44mztf000h4sv28jz5dexl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vue-router" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/15/vue-router/" class="article-date">
  <time datetime="2019-10-15T06:35:56.000Z" itemprop="datePublished">2019-10-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/15/vue-router/">vue-router</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>概述: 如何使用vue-router以及如何实现简版的vue-router.<br>vue-router为了实现单页面应用，在浏览器地址栏变化时，去修改url history栈，去实现切换页面，并且不用发送请求。</p>
<h2 id="vue-router使用"><a href="#vue-router使用" class="headerlink" title="vue-router使用"></a>vue-router使用</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装:"></a>安装:</h3><p>前提使用vue-cli创建的项目,才能使用vue 命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue add router</span><br></pre></td></tr></table></figure>

<h3 id="配置router-js"><a href="#配置router-js" class="headerlink" title="配置router.js"></a>配置router.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">'./views/Home.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用插件：做了什么？ install</span></span><br><span class="line"><span class="comment">// install里面做了什么？</span></span><br><span class="line"><span class="comment">// 1.挂在$router</span></span><br><span class="line"><span class="comment">// 2.注册组件 router-link 和router-view</span></span><br><span class="line"><span class="comment">// router做了什么？</span></span><br><span class="line"><span class="comment">// 1.解析路由配置</span></span><br><span class="line"><span class="comment">// 2.响应url变化</span></span><br><span class="line"><span class="comment">// 3.事件监听hashchange</span></span><br><span class="line"><span class="comment">// 4.组件切换？怎么切换？</span></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/'</span>,</span><br><span class="line">      name: <span class="string">'home'</span>,</span><br><span class="line">      component: Home</span><br><span class="line">    &#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="在main-js-中添加到vue选项"><a href="#在main-js-中添加到vue选项" class="headerlink" title="在main.js 中添加到vue选项"></a>在main.js 中添加到vue选项</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    router, <span class="comment">//为什么挂载 ? 为了全局使用，成为Vue实例的options属性下的属性-$router</span></span><br><span class="line">    render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="导航链接"><a href="#导航链接" class="headerlink" title="导航链接"></a>导航链接</h3><p>使用 router-link 组件来导航.<br>通过传入 <code>to</code> 属性指定链接.<br>router-link 默认会被渲染成一个 <code>&lt;a&gt;</code> 标签</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="路由出口"><a href="#路由出口" class="headerlink" title="路由出口"></a>路由出口</h3><p>路由匹配到的组件将渲染在这里</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h3><p>把某种模式匹配到的所有路由, 全部映射到同一个组件</p>
<ul>
<li><p>创建Detail.vue</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>商品详情<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; $route.params.id &#125;&#125;<span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>为组件Detail.vue配置路由, router.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    path: <span class="string">'/detail/:id'</span>,</span><br><span class="line">    name: <span class="string">'detial'</span>,</span><br><span class="line">    component: Detail</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>路由跳转, Home.vue</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"item in items"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"`/detail/$&#123;item.id&#125;`"</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="路由嵌套"><a href="#路由嵌套" class="headerlink" title="路由嵌套"></a>路由嵌套</h3><ul>
<li><p>路由配置 router.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    path: <span class="string">'/'</span>,</span><br><span class="line">    name: <span class="string">'home'</span>,</span><br><span class="line">    component: Home,</span><br><span class="line">    children: [&#123;</span><br><span class="line">        path: <span class="string">'/detail/:id'</span>,</span><br><span class="line">        name: <span class="string">'detail'</span>,</span><br><span class="line">        component: Detail</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在Home.vue 添加 router-view, 子组件将来就会填充在此 (占位)<br>路由嵌套了多少个子路由,就有多少个router-view 占位, 子路由里面还有子路由,对应的router-view里也有router-view占位.</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"home"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="实现自己的vue-router"><a href="#实现自己的vue-router" class="headerlink" title="实现自己的vue-router"></a>实现自己的vue-router</h2><ul>
<li>思路: router做了什么?</li>
</ul>
<ol>
<li>解析路由配置对象,生成map</li>
<li>响应url变化</li>
<li>事件监听hashchange</li>
<li>组件切换? 怎么切换?</li>
</ol>
<h3 id="创建一个VueRouter类"><a href="#创建一个VueRouter类" class="headerlink" title="创建一个VueRouter类"></a>创建一个VueRouter类</h3><p>创建zvue-router.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现 自己的VueRouter类</span></span><br><span class="line"><span class="comment">// 需要实现的 功能</span></span><br><span class="line"><span class="comment">// 1.解析routes配置:生成map对象，&#123;'/': Home, '/about': About&#125;</span></span><br><span class="line"><span class="comment">// 2.响应url变化</span></span><br><span class="line"><span class="comment">// 3.事件监听hashchange</span></span><br><span class="line"><span class="comment">// 4.组件切换</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Vue</span><br><span class="line"><span class="comment">// 声明Router类</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ZVueRouter</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1.解析route配置,生成routeMap对象(指定路由映射指定的组件)</span></span><br><span class="line">    <span class="keyword">constructor</span>(options) &#123;</span><br><span class="line">        <span class="keyword">this</span>.$options = options</span><br><span class="line">        <span class="comment">// 路由映射表对象 用来保存 路由 和 路由指定的组件</span></span><br><span class="line">        <span class="keyword">this</span>.routeMap = &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// url响应化处理: 只要url变化, 用到url 的组件就会重新渲染</span></span><br><span class="line">        <span class="comment">// vue-router 跟vue强耦合 ,因此这个插件只能用于vue, current保存当前hash,vue使其是响应式的</span></span><br><span class="line">        <span class="keyword">this</span>.app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">            data: &#123;</span><br><span class="line">                current: <span class="string">'/'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 声明初始化函数</span></span><br><span class="line">    init() &#123;</span><br><span class="line">        <span class="comment">// 1. 事件监听</span></span><br><span class="line">        <span class="keyword">this</span>.bindEvents()</span><br><span class="line">        <span class="comment">// 2. 路由映射操作</span></span><br><span class="line">        <span class="keyword">this</span>.createRouteMap()</span><br><span class="line">        <span class="comment">// 3. 组件声明和注册</span></span><br><span class="line">        <span class="keyword">this</span>.initComponent()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 监听hashchange事件, 当hash值改变时,就会触发事件,然后执行回调函数,将改变当前我们保存的路由的hash值.</span></span><br><span class="line">    bindEvents() &#123;</span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'hashchange'</span>, <span class="keyword">this</span>.onHashChange.bind(<span class="keyword">this</span>))</span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, <span class="keyword">this</span>.onHashChange.bind(<span class="keyword">this</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    onHashChange() &#123;</span><br><span class="line">        <span class="comment">// #/index</span></span><br><span class="line">        <span class="keyword">this</span>.app.current = <span class="built_in">window</span>.location.hash.slice(<span class="number">1</span>) || <span class="string">'/'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 做路由映射</span></span><br><span class="line">    <span class="comment">// 源码中是递归遍历，因为有嵌套路由</span></span><br><span class="line">    createRouteMap() &#123;</span><br><span class="line">        <span class="keyword">this</span>.$options.routes.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.routeMap[item.path] = item</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 初始化组件    </span></span><br><span class="line">    initComponent() &#123;</span><br><span class="line">        <span class="comment">// 函数式声明组件</span></span><br><span class="line">        <span class="comment">// 声明 组件 &lt;router-link&gt;</span></span><br><span class="line">        <span class="comment">// &lt;router-link to="/"&gt;abc&lt;/router-link&gt; </span></span><br><span class="line">        Vue.component(<span class="string">'router-link'</span>, &#123;</span><br><span class="line">            props: &#123;</span><br><span class="line">                to: <span class="built_in">String</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// render选项</span></span><br><span class="line">            <span class="comment">// h(tag, data, children)</span></span><br><span class="line">            render(h) &#123;</span><br><span class="line">                <span class="comment">// 此处的this 是当前组件的实例</span></span><br><span class="line">                <span class="keyword">return</span> h(<span class="string">'a'</span>, &#123;<span class="attr">attrs</span>: &#123;<span class="attr">href</span>: <span class="string">'#'</span> + <span class="keyword">this</span>.to&#125;&#125;, [<span class="keyword">this</span>.$slots.default])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// &lt;router-view&gt;</span></span><br><span class="line">        <span class="comment">// 路由出口, 将来组件会插在此处</span></span><br><span class="line">        Vue.component(<span class="string">'router-view'</span>, &#123;</span><br><span class="line">            render: <span class="function">(<span class="params">h</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 拿出要渲染的组件</span></span><br><span class="line">                <span class="comment">// this 希望是ZVueRouter实例</span></span><br><span class="line">                <span class="keyword">const</span> component = <span class="keyword">this</span>.routeMap[<span class="keyword">this</span>.app.current].component</span><br><span class="line">                <span class="keyword">return</span> h(component)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现插件</span></span><br><span class="line"><span class="comment">// 插件接受Vue构造函数</span></span><br><span class="line">ZVueRouter.install = <span class="function"><span class="keyword">function</span> (<span class="params">_Vue</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 保存Vue构造函数,就可以方便使用了.</span></span><br><span class="line">    Vue = _Vue</span><br><span class="line">    <span class="comment">// 混入: 执行挂载操作</span></span><br><span class="line">    Vue.mixin(&#123;</span><br><span class="line">        beforeCreate() &#123;</span><br><span class="line">            <span class="comment">// 确保是根组件时执行一次, 将router实例放到Vue原型上,以后所有vue组件实例就都有$router</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.$options.router) &#123;</span><br><span class="line">                <span class="comment">// 这里的this 是vue实例 </span></span><br><span class="line">                Vue.prototype.$router = <span class="keyword">this</span>.$options.router</span><br><span class="line">                <span class="comment">// 执行初始化</span></span><br><span class="line">                <span class="keyword">this</span>.$options.router.init()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="创建路由配置文件zrouter-js-使用自定义路由"><a href="#创建路由配置文件zrouter-js-使用自定义路由" class="headerlink" title="创建路由配置文件zrouter.js, 使用自定义路由"></a>创建路由配置文件zrouter.js, 使用自定义路由</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> ZVueRouter <span class="keyword">from</span> <span class="string">'./zvue-router.js'</span></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">'./views/Home.vue'</span></span><br><span class="line"><span class="keyword">import</span> About <span class="keyword">from</span> <span class="string">'./views/About.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Vue.use() 应用插件, 里面会调用一个install 方法</span></span><br><span class="line"><span class="comment">// install 方法里面会:</span></span><br><span class="line"><span class="comment">// 1. 挂载$router</span></span><br><span class="line"><span class="comment">// 2. 生命$route</span></span><br><span class="line"><span class="comment">// 3. 注册组件</span></span><br><span class="line">Vue.use(ZVueRouter)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> ZVueRouter(&#123;</span><br><span class="line">    routes: [</span><br><span class="line">        &#123;</span><br><span class="line">            path: <span class="string">'/'</span>,</span><br><span class="line">            name: <span class="string">'home'</span>,</span><br><span class="line">            component: Home</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path: <span class="string">"/about"</span>,</span><br><span class="line">            name: <span class="string">'about'</span>,</span><br><span class="line">            component: About</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="在main-js-里引入路由配置zrouter-js-并写入选项"><a href="#在main-js-里引入路由配置zrouter-js-并写入选项" class="headerlink" title="在main.js 里引入路由配置zrouter.js, 并写入选项"></a>在main.js 里引入路由配置zrouter.js, 并写入选项</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="comment">// import router from './router'</span></span><br><span class="line"><span class="comment">// 导入自己的路由配置文件</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./zrouter.js'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  router,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/15/vue-router/" data-id="ckh44mzu200154sv2ma3iyxpw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-sync和v-model的异同" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/14/sync和v-model的异同/" class="article-date">
  <time datetime="2019-10-14T01:57:26.000Z" itemprop="datePublished">2019-10-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/14/sync和v-model的异同/">.sync和v-model的异同</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>使用sync 可以实现和 v-model 相同的效果,但是它们之间有何异同呢?</p>
<h2 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h2><p>v-model通常用于表单控件,这样子组件有更强控制能力.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- v-model 是语法糖 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 等效于下面这行 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">z-input</span> <span class="attr">:value</span>=<span class="string">"username"</span> @<span class="attr">input</span>=<span class="string">"username=$event"</span>&gt;</span><span class="tag">&lt;<span class="name">z-input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">z-checkbox</span> <span class="attr">v-model</span>=<span class="string">"remember"</span>&gt;</span><span class="tag">&lt;/<span class="name">z-checkbox</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 设置model选项修改默认行为 等效于下面这行 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;z-checkbox :checked="remember" @change="remember=$event"&gt;&lt;/z-checkbox&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">    model: &#123;</span><br><span class="line"><span class="javascript">        prop: <span class="string">'checked'</span>,</span></span><br><span class="line"><span class="javascript">        event: <span class="string">'change'</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="sync修饰符"><a href="#sync修饰符" class="headerlink" title=".sync修饰符"></a>.sync修饰符</h2><p>sync 修饰符2.3.0+新增,它能用于修改传递到子组件的属性.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">z-input</span> <span class="attr">:foo.sync</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">z-input</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 等效于下面这行 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">z-input</span> <span class="attr">:foo</span>=<span class="string">"username"</span> @<span class="attr">update:foo</span>=<span class="string">"username=$event"</span>&gt;</span><span class="tag">&lt;/<span class="name">z-input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"> <span class="comment">&lt;!-- z-input 内部 --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> @<span class="attr">input</span>=<span class="string">"$emit('update:foo', $event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>出现 sync的原因:<br>在有些情况下，我们可能需要对一个 prop 进行“双向绑定”。不幸的是，真正的双向绑定会带来维护上的问题，因为子组件可以修改父组件，且在父组件和子组件都没有明显的改动来源。所以用 update:myPropName 的模式触发事件取而代之.<br>内部实现原理:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 子组件内部 </span></span><br><span class="line"><span class="keyword">this</span>.$emit(<span class="string">'update:title'</span>, newTitle)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 父组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">text-document</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-bind:title</span>=<span class="string">"doc.title"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-on:update:title</span>=<span class="string">"doc.title = $event"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">text-document</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>简写方式.sync修饰符:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">text-document</span> <span class="attr">v-bind:title.sync</span>=<span class="string">"doc.title"</span>&gt;</span><span class="tag">&lt;/<span class="name">text-document</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>同时设置多个prop时,使用对象将每一个属性都作为一个独立的prop传进去,然后各自添加用于更新的v-on监听器.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">text-document</span> <span class="attr">v-bind.sync</span>=<span class="string">"doc"</span>&gt;</span><span class="tag">&lt;/<span class="name">text-document</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结:<br>    场景:父组件传递的属性子组件想修改<br>    所以sync修饰符的控制能力都在父级,事件名称也相对固定update:xx<br>    习惯上表单元素用v-model</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/14/sync和v-model的异同/" data-id="ckh44mzu100144sv22wgkfx9j" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vue组件化实战" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/11/vue组件化实战/" class="article-date">
  <time datetime="2019-10-11T03:33:40.000Z" itemprop="datePublished">2019-10-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/11/vue组件化实战/">vue组件化实战</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>目标: 通过vue 实现自己的 表单组件: input, form<br>效果: 实现类似如一些前端组件库里面提供的表单组件</p>
<h1 id="组件实战"><a href="#组件实战" class="headerlink" title="组件实战"></a>组件实战</h1><p>表单组件内部原理:</p>
<ol>
<li>input 输入框,要实现双向绑定.</li>
<li>form-item 实现了自己的内容验证(validate函数),当input 没有输入时,会触发.</li>
<li>在最外层form组件里,点击提交button,会进行全局的input内容校验.然后就会触发通知弹窗,根据校验的结果显示不同的notice信息.</li>
</ol>
<h2 id="实现input-组件"><a href="#实现input-组件" class="headerlink" title="实现input 组件"></a>实现input 组件</h2><ul>
<li><p>创建 components/Zinput.vue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input :type=&quot;type&quot; :value=&quot;value&quot; @input=&quot;onInput($event)&quot;&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;ZInput&apos;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      a: &apos;a&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    type: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &apos;text&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    value: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    onInput(e) &#123;</span><br><span class="line">      // 触发父组件给当前组件绑定的input事件. 并将子组件里写入input的值作为参数传入.</span><br><span class="line">      this.$emit(&apos;input&apos;, e.target.value)</span><br><span class="line">      // 通知父组件form-item 做内容校验</span><br><span class="line">      this.$parent.$emit(&apos;validate&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>父组件中使用Zinput</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- &lt;z-input v-model=&quot;msg.account&quot;&gt;&lt;/z-input&gt; --&gt;</span><br><span class="line">    &lt;!-- v-model实际只是一个语法糖， 真正的原理是下面的value + input --&gt;</span><br><span class="line">    &lt;z-input :value=&quot;msg.account&quot; @input=&quot;msg.account=$event&quot;&gt;&lt;/z-input&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; msg.account &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ZInput from &apos;./components/Zinput.vue&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;app&apos;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    ZInput</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#123;</span><br><span class="line">        account: &apos;&apos;,</span><br><span class="line">        password: &apos;&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="实现form-item-组件"><a href="#实现form-item-组件" class="headerlink" title="实现form-item 组件"></a>实现form-item 组件</h2><ul>
<li>创建 components/ZFormItem.vue<br>组件内引用了 异步验证的库async-validator,需要先使用npm install async-validator -S安装这个库.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;label v-if=&quot;label&quot;&gt;&#123;&#123; label &#125;&#125;&lt;/label&gt;</span><br><span class="line">        &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">        &lt;p v-if=&quot;errorMessage&quot;&gt;&#123;&#123;errorMessage&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Schema from &apos;async-validator&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &apos;ZFormItem&apos;,</span><br><span class="line">    inject: [&apos;form&apos;], // 注入</span><br><span class="line">    props: &#123;</span><br><span class="line">        label: &#123; // 输入项标签</span><br><span class="line">            type: String,</span><br><span class="line">            default: &apos;&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        prop: &#123; // 字段名</span><br><span class="line">            type: String,</span><br><span class="line">            default: &apos;&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            errorMessage: &apos;&apos; //校验错误</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted() &#123;</span><br><span class="line">        // 监听 validate事件</span><br><span class="line">        this.$on(&apos;validate&apos;, () =&gt; &#123;</span><br><span class="line">            this.validate()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        validate() &#123;</span><br><span class="line">            // 获取对应FormItem 的校验规则</span><br><span class="line">            const rule = this.form.rules[this.prop]</span><br><span class="line">            // 获取校验值</span><br><span class="line">            const msg = this.form.msg[this.prop]</span><br><span class="line">            // 创建校验规则</span><br><span class="line">            const descriptor = &#123; [this.prop]: rule &#125;</span><br><span class="line">            // 创建校验器</span><br><span class="line">            const schema = new Schema(descriptor)</span><br><span class="line">            // 校验返回Promise对象,没有触发catch就说明验证通过</span><br><span class="line">            return schema.validate(&#123; [this.prop]: msg&#125;, error =&gt; &#123;</span><br><span class="line">                if (error) &#123;</span><br><span class="line">                    // 将错误信息显示</span><br><span class="line">                    this.errorMessage = error[0].message;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    // 校验通过</span><br><span class="line">                    this.errorMessage = &apos;&apos;</span><br><span class="line">                &#125; </span><br><span class="line">            &#125;)</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="实现form-组件"><a href="#实现form-组件" class="headerlink" title="实现form 组件"></a>实现form 组件</h2><ul>
<li>创建 components/ZForm.vue<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;slot&gt;&lt;/slot&gt;    </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    provide() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            form: this // 将当前组件实例作为提供者, 子代组件可以更加方便的获得</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    props: &#123;</span><br><span class="line">        msg: &#123;</span><br><span class="line">            type: Object,</span><br><span class="line">            required: true</span><br><span class="line">        &#125;,</span><br><span class="line">        rules: &#123;</span><br><span class="line">            type: Object</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        // 表单全局验证, 为Form 提供validate方法.</span><br><span class="line">        validate(callback) &#123;</span><br><span class="line">            console.log(&quot;全局校验&quot;)</span><br><span class="line">            // 1. 先筛选出含有prop属性的子组件,然后调用它们的validate方法并得到Promise数组</span><br><span class="line">            const tasks = this.$children</span><br><span class="line">                .filter(item =&gt; item.prop)</span><br><span class="line">                .map(item =&gt; item.validate())</span><br><span class="line">            // 2. 所有任务必须全部成功才算校验通过</span><br><span class="line">            Promise.all(tasks)</span><br><span class="line">                .then(() =&gt; callback(true))</span><br><span class="line">                .catch(() =&gt; callback(false))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="实现通知组件"><a href="#实现通知组件" class="headerlink" title="实现通知组件"></a>实现通知组件</h2><ul>
<li>创建 components/Notice.vue<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;box&quot; v-if=&quot;isShow&quot;&gt;</span><br><span class="line">        &lt;h3&gt;&#123;&#123; title &#125;&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;p class=&quot;box-content&quot;&gt;&#123;&#123; message &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &apos;Notice&apos;,</span><br><span class="line">    props: &#123;</span><br><span class="line">        title: &#123;</span><br><span class="line">            type: String,</span><br><span class="line">            default: &apos;&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        message: &#123;</span><br><span class="line">            type: String,</span><br><span class="line">            default: &apos;&apos;</span><br><span class="line">        &#125;,</span><br><span class="line">        duration: &#123;</span><br><span class="line">            type: Number,</span><br><span class="line">            default: 1000</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            isShow: false</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        show() &#123;</span><br><span class="line">            this.isShow = true</span><br><span class="line">            setTimeout(this.hide, this.duration)</span><br><span class="line">        &#125;,</span><br><span class="line">        hide() &#123;</span><br><span class="line">            this.isShow = false;</span><br><span class="line">            this.remove();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.box &#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    width: 100%;</span><br><span class="line">    top: 16px;</span><br><span class="line">    left: 0;</span><br><span class="line">    text-align: center;</span><br><span class="line">    pointer-events: none;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    border: grey 3px solid;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line">.box-content &#123;</span><br><span class="line">    width: 200px;</span><br><span class="line">    margin: 10px auto;</span><br><span class="line">    font-size: 14px;  </span><br><span class="line">    padding: 8px 16px;</span><br><span class="line">    background: #fff;</span><br><span class="line">    border-radius: 3px;</span><br><span class="line">    margin-bottom: 8px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="实现弹窗组件"><a href="#实现弹窗组件" class="headerlink" title="实现弹窗组件"></a>实现弹窗组件</h2><p>弹窗组件的特点是他们在当前vue实例之外独立存在,通常挂载在body上;它们是通过JS 动态创建的, 不需要在任何组件中声明.通过create函数,来动态创建 通知组件.</p>
<ul>
<li>创建 utils/create.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line"></span><br><span class="line">// create函数 接收要创建的组件 和传入的值 作为参数</span><br><span class="line">function create(Component, props) &#123;</span><br><span class="line">    // 1. 创建Component实例</span><br><span class="line">    const vm = new Vue(&#123;</span><br><span class="line">        // render函数将传入组件配置对象转换为虚拟dom</span><br><span class="line">        render(h) &#123;</span><br><span class="line">            // 渲染函数 使用</span><br><span class="line">            // h == createElement</span><br><span class="line">            // h(Component) =&gt; vdom</span><br><span class="line">            return h(Component, &#123; props &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).$mount() // 执行挂载函数,但未制定挂载目标,表示只执行初始化工作(先渲染不挂载)</span><br><span class="line"></span><br><span class="line">    // 方式2：Vue.extend() 返回组件构造函数</span><br><span class="line">    // const Ctor = Vue.extend(Component)</span><br><span class="line">    // const comp = new Ctor(&#123;propsData: props&#125;)    </span><br><span class="line">    // document.body.appendChild(comp.$el)</span><br><span class="line">    // 将生成的dom元素 追加至 body</span><br><span class="line"></span><br><span class="line">    // 获取dom</span><br><span class="line">    document.body.appendChild(vm.$el)</span><br><span class="line">    // 2. 挂载 </span><br><span class="line">    const comp = vm.$children[0]</span><br><span class="line">    // 3. 销毁</span><br><span class="line">    comp.remove = () =&gt; &#123;</span><br><span class="line">        document.body.removeChild(vm.$el)</span><br><span class="line">        vm.$destroy()</span><br><span class="line">    &#125;</span><br><span class="line">    return comp</span><br><span class="line">&#125;</span><br><span class="line">export default create</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="使用Form-表单"><a href="#使用Form-表单" class="headerlink" title="使用Form 表单."></a>使用Form 表单.</h2><ul>
<li>创建 index.vue<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h3&gt;ZForm表单&lt;/h3&gt;</span><br><span class="line">        &lt;hr&gt;</span><br><span class="line">        &lt;z-form :msg=&quot;msg&quot; :rules=&quot;rules&quot; ref=&quot;loginForm&quot;&gt;</span><br><span class="line">            &lt;z-form-item label=&quot;用户名&quot; prop=&quot;username&quot;&gt;</span><br><span class="line">                &lt;z-input v-model=&quot;msg.username&quot;&gt;&lt;/z-input&gt;</span><br><span class="line">            &lt;/z-form-item&gt;</span><br><span class="line">            &lt;z-form-item label=&quot;密码&quot; prop=&quot;password&quot;&gt;</span><br><span class="line">                &lt;z-input type=&quot;password&quot; v-model=&quot;msg.password&quot;&gt;&lt;/z-input&gt;</span><br><span class="line">            &lt;/z-form-item&gt;</span><br><span class="line">            &lt;z-form-item&gt;</span><br><span class="line">                &lt;button @click=&quot;submitForm&quot;&gt;Submit&lt;/button&gt;</span><br><span class="line">            &lt;/z-form-item&gt;</span><br><span class="line">        &lt;/z-form&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ZForm from &apos;../ZForm&apos;</span><br><span class="line">import ZFormItem from &apos;../ZFormItem&apos;</span><br><span class="line">import ZInput from &apos;../Zinput&apos;</span><br><span class="line">import create from &apos;@/utils/create.js&apos;</span><br><span class="line">import Notice from &apos;@/components/form/Notice&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">        ZForm,</span><br><span class="line">        ZFormItem,</span><br><span class="line">        ZInput</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            rules: &#123;</span><br><span class="line">                username: [&#123; required: true, message: &quot;请输入用户名&quot; &#125;],</span><br><span class="line">                password: [&#123; required: true, message: &quot;请输入密码&quot; &#125;]</span><br><span class="line">            &#125;,</span><br><span class="line">            msg: &#123;</span><br><span class="line">                username: &apos;&apos;,</span><br><span class="line">                password: &apos;&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        submitForm() &#123;</span><br><span class="line">            this.$refs.loginForm.validate(valid =&gt; &#123;</span><br><span class="line">                const notice = create(Notice, &#123;</span><br><span class="line">                    title: &quot;Notice&quot;,</span><br><span class="line">                    message: valid ? &quot;请求登录!&quot; : &quot;校验失败!&quot;,</span><br><span class="line">                    duration: 3000</span><br><span class="line">                &#125;)</span><br><span class="line">                notice.show()</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="递归组件"><a href="#递归组件" class="headerlink" title="递归组件"></a>递归组件</h1><p>递归组件是可以在它们自己模板中调用自身的组件.</p>
<ul>
<li><p>创建recursion/node.vue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h3&gt;&#123;&#123; data.title &#125;&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;!-- 递归组件必须要有结束的条件 --&gt;</span><br><span class="line">        &lt;node v-for=&quot;d in data.children&quot; :key=&quot;d.id&quot; :data=&quot;d&quot;&gt;&lt;/node&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &apos;Node&apos;, // name 对递归组件是必要的.</span><br><span class="line">    props: &#123;</span><br><span class="line">        data: &#123;</span><br><span class="line">            type: Object,</span><br><span class="line">            required: true</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用node.vue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;node :data=&quot;data&quot;&gt;&lt;/node&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Node from &quot;./Node.vue&quot;</span><br><span class="line">export default &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">        Node</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            data: &#123;</span><br><span class="line">                id: &apos;1&apos;,</span><br><span class="line">                title: &apos;递归组件使用手册&apos;,</span><br><span class="line">                children: [</span><br><span class="line">                    &#123; id: &apos;1-1&apos;, title: &apos;使用方法&apos;&#125;,</span><br><span class="line">                    &#123; id: &apos;1-2&apos;, title: &apos;注意事项&apos;&#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="Tree递归组件实现"><a href="#Tree递归组件实现" class="headerlink" title="Tree递归组件实现"></a>Tree递归组件实现</h2><p>Tree组件是典型的递归组件,其他的诸如菜单组件都属于这一类,也是相当常见的。</p>
<ul>
<li><p>创建components/tree/Titem.vue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;li&gt;</span><br><span class="line">            &lt;div @click=&quot;toggle&quot;&gt;</span><br><span class="line">                &#123;&#123;model.title&#125;&#125;</span><br><span class="line">                &lt;span v-if=&quot;isFolder&quot;&gt;[&#123;&#123; open ? &apos;-&apos; : &apos;+&apos; &#125;&#125;]&lt;/span&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;ul v-show=&quot;open&quot; v-if=&quot;isFolder&quot;&gt;</span><br><span class="line">                &lt;t-item class=&quot;item&quot; v-for=&quot;m in model.children&quot; :model=&quot;m&quot; :key=&quot;m.title&quot;&gt;&lt;/t-item&gt;</span><br><span class="line">            &lt;/ul&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &quot;TItem&quot;,</span><br><span class="line">    props: &#123;</span><br><span class="line">        model: Object</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            open: false</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line">        isFolder() &#123;</span><br><span class="line">            return this.model.children &amp;&amp; this.model.children.length</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        toggle() &#123;</span><br><span class="line">            if (this.isFolder) &#123;</span><br><span class="line">                this.open = !this.open</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用Titem</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"> &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">   &lt;ul&gt;</span><br><span class="line">     &lt;t-item class=&quot;item&quot; :model=&quot;treeData&quot;&gt;&lt;/t-item&gt;</span><br><span class="line">   &lt;/ul&gt;</span><br><span class="line"> &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import TItem from &quot;./Titem.vue&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            treeData: &#123;</span><br><span class="line">                title: &quot;Web全栈架构师&quot;,</span><br><span class="line">                children: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        title: &quot;Java架构师&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        title: &quot;JS高级&quot;,</span><br><span class="line">                        children: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                title: &quot;ES6&quot;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                title: &quot;动效&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        ]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        title: &quot;Web全栈&quot;,</span><br><span class="line">                        children: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                title: &quot;Vue训练营&quot;,</span><br><span class="line">                                expand: true,</span><br><span class="line">                                children: [</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        title: &quot;组件化&quot;</span><br><span class="line">                                    &#125;,</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        title: &quot;源码&quot;</span><br><span class="line">                                    &#125;,</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        title: &quot;docker部署&quot;</span><br><span class="line">                                    &#125;]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                title: &quot;React&quot;,</span><br><span class="line">                                children: [</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        title: &quot;JSX&quot;</span><br><span class="line">                                    &#125;,</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        title: &quot;虚拟DOM&quot;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                ]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                title: &quot;Node&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        ]</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123; </span><br><span class="line">        TItem</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.item &#123;</span><br><span class="line"> text-align: left;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/11/vue组件化实战/" data-id="ckh44mzv0001o4sv2reujlr4e" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vue-component" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/10/vue-component/" class="article-date">
  <time datetime="2019-10-10T03:40:16.000Z" itemprop="datePublished">2019-10-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/10/vue-component/">vue-component</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Vue 组件化实践</p>
<h1 id="组件化"><a href="#组件化" class="headerlink" title="组件化"></a>组件化</h1><p>组件化是vue 的核心思想，提高开发效率，方便重复使用，简化调试，提升整个项目的可维护性，便于多人协同开发。</p>
<h2 id="组件通信"><a href="#组件通信" class="headerlink" title="组件通信"></a>组件通信</h2><h3 id="父组件将数据传入-获取-子组件内的方法"><a href="#父组件将数据传入-获取-子组件内的方法" class="headerlink" title="父组件将数据传入(获取)子组件内的方法"></a>父组件将数据传入(获取)子组件内的方法</h3><ul>
<li><p>props 属性</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在父组件中使用子组件，通过自定义属性的方式，将指定的数据传入子组件。</span></span><br><span class="line">&lt;childcomponent msg=<span class="string">"welcome to vue"</span>&gt;&lt;/childcomponent&gt;</span><br><span class="line"><span class="comment"># 在子组件内部，要使用父组件传入的数据，可以先使用props属性指定传入的属性，然后就可以通过this.msg的方式访问</span></span><br><span class="line">props: &#123; msg: string&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>实例属性 $attrs<br>$attrs对象会包含了父作用域中不作为 prop 被识别 (且获取) 的特性绑定 (class 和 style 除外)。<br>当一个组件没有声明任何 prop 时，这里会包含所有父作用域的绑定 (class 和 style 除外)，并且可以通过 v-bind=”$attrs” 传入内部组件,内部组件的$attrs就包含了外层组件的$attrs对象中的内容——在创建高级别的组件时非常有用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 前提 是没有在子组件中使用props声明。</span></span><br><span class="line"><span class="comment"># 父组件中</span></span><br><span class="line">&lt;childcomponent msg=<span class="string">"welcome to vue"</span>&gt;&lt;/childcomponent&gt;</span><br><span class="line"><span class="comment"># 将父组件的所有绑定的属性传给子组件(除了class和style)</span></span><br><span class="line">&lt;childcomponent v-bind=<span class="string">"<span class="variable">$attrs</span>"</span>&gt;&lt;/childcomponent&gt;</span><br><span class="line"><span class="comment"># 子组件中 并未在props中声明msg，可以在子组件中使用$attrs</span></span><br><span class="line">&lt;p&gt;&#123;&#123; <span class="variable">$attrs</span>.msg &#125;&#125;&lt;/p&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用ref和$refs ，可以引用子组件内部的数据和方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 父组件</span></span><br><span class="line">&lt;childcomponent ref=<span class="string">"child"</span>&gt;&lt;/childcomponent&gt;</span><br><span class="line"><span class="comment"># 在父组件中就可以使用子组件中的数据 和 方法</span></span><br><span class="line"><span class="function"><span class="title">mounted</span></span>() &#123;</span><br><span class="line">    this.<span class="variable">$refs</span>.child.foo = <span class="string">'xxxx'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>实例属性$children<br>当前实例的直接子组件。需要注意 $children 并不保证顺序，也不是响应式的。如果你发现自己正在尝试使用 $children 来进行数据绑定，考虑使用一个数组配合 v-for 来生成子组件，并且使用 Array 作为真正的来源。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 父组件</span></span><br><span class="line">this.<span class="variable">$children</span>[0].foo = <span class="string">'xxx'</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="子组件使用父组件内的数据的方法"><a href="#子组件使用父组件内的数据的方法" class="headerlink" title="子组件使用父组件内的数据的方法"></a>子组件使用父组件内的数据的方法</h3><ul>
<li>使用 $parent 来访问父组件的数据<br>$parent : 当前组件的父实例<br>$root : 当前组件树的根Vue实例。如果当前实例没有父实例，此实例将会是其自己。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.$parent.xxx</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="给子组件绑定事件的方式-和-emit"><a href="#给子组件绑定事件的方式-和-emit" class="headerlink" title="给子组件绑定事件的方式 和 $emit"></a>给子组件绑定事件的方式 和 $emit</h3><ul>
<li>通过子组件调用时，传递参数的方式，将子组件的数据传递到父组件，给父组件使用。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 父组件内 在子组件上自定义事件，并绑定这个事件触发时，要执行的函数。</span></span><br><span class="line"><span class="comment"># $event : 通过$event 可以访问原始的 DOM 事件。</span></span><br><span class="line">&lt;childcom @addevent=<span class="string">"func(<span class="variable">$event</span>, argu)"</span>&gt;&lt;/childcom&gt;</span><br><span class="line"></span><br><span class="line">func(event,argu) &#123;</span><br><span class="line">    ...code block</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 子组件内 触发这个自定义事件, 并传递参数,这个参数可以让父组件的变量接收,从而达到改变父组件的数据的作用.</span></span><br><span class="line">this.<span class="variable">$emit</span>(<span class="string">'addevent'</span>, <span class="string">'argument'</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="兄弟组件之间传值的方法"><a href="#兄弟组件之间传值的方法" class="headerlink" title="兄弟组件之间传值的方法"></a>兄弟组件之间传值的方法</h3><ul>
<li><p>方法1<br>思想 ： 父组件做桥梁,先通过父组件给 子组件1 传递一个 事件，子组件触发这个事件的时候，会改变父组件的data，并且将这个data通过自定义属性的方式传递给 子组件2,子组件2 内使用props声明，就能使用 这个data。从而达到 兄弟组件之间传值的目的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># parent component</span></span><br><span class="line">&lt;component1 @showMsg=<span class="string">"func"</span>&gt;&lt;/component1&gt;</span><br><span class="line">&lt;component2 :msg=<span class="string">"msg"</span>&gt;&lt;/component2&gt;</span><br><span class="line"></span><br><span class="line">data: msg:<span class="string">''</span></span><br><span class="line"></span><br><span class="line">methods:</span><br><span class="line">func(msg) &#123;</span><br><span class="line">    this.msg =msg</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># component1</span></span><br><span class="line">this.<span class="variable">$emit</span>(<span class="string">'showMsg'</span>, <span class="string">'news'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># component2</span></span><br><span class="line">props: &#123;</span><br><span class="line">    msg: string</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法2<br>$on: 监听一个自定义事件,回调函数就是事件触发时要执行的操作,$emit触发事件,回调函数会接受参数并处理.<br>$emit: 触发当前实例上的事件。附加参数都会传给监听器的回调函数。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># component1 send data </span></span><br><span class="line">this.<span class="variable">$parent</span>.<span class="variable">$emit</span>(<span class="string">'showMsgevent'</span>， <span class="string">'message'</span>)</span><br><span class="line"><span class="comment"># component2 receive data </span></span><br><span class="line">this.<span class="variable">$parent</span>.<span class="variable">$on</span>(<span class="string">'showMsgevent'</span>, (msg) =&gt; &#123;</span><br><span class="line">    this.msg = msg</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="祖先和后代之间传值"><a href="#祖先和后代之间传值" class="headerlink" title="祖先和后代之间传值"></a>祖先和后代之间传值</h3><p>嵌套层数过多时， 传递props不切实际，vue 提供了 provide/inject API 实现。<br>这对选项需要一起使用，以允许一个祖先组件向其所有子孙后代注入一个依赖，不论组件层次有多深，并在起上下游关系成立的时间里始终生效。</p>
<ul>
<li>provide/inject选项<br>provide 选项应该是一个对象或返回一个对象的函数。<br>提示：provide 和 inject 绑定并不是可响应的。这是刻意为之的。然而，如果你传入了一个可监听的对象，那么其对象的属性还是可响应的。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 父级组件</span></span><br><span class="line">provide: &#123;</span><br><span class="line">    foo: <span class="string">'foo'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 函数写法</span></span><br><span class="line"><span class="function"><span class="title">provide</span></span>() &#123;</span><br><span class="line">    <span class="built_in">return</span> &#123;</span><br><span class="line">      author: <span class="string">'richard'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 子组件注入</span></span><br><span class="line">inject: [<span class="string">'foo'</span>]</span><br><span class="line"><span class="comment"># 子组件注入</span></span><br><span class="line">inject: &#123;</span><br><span class="line">    foo: &#123;</span><br><span class="line">        from: <span class="string">'bar'</span>,</span><br><span class="line">        default: <span class="string">'foo'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 在子组件中使用</span></span><br><span class="line">this.foo</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="任意两个组件之间传值：-事件总线-或者-vuex"><a href="#任意两个组件之间传值：-事件总线-或者-vuex" class="headerlink" title="任意两个组件之间传值： 事件总线 或者 vuex"></a>任意两个组件之间传值： 事件总线 或者 vuex</h3><ul>
<li><p>事件总线</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新建Bus.js: 事件派发、监听和回调管理</span></span><br><span class="line">class Bus&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span></span>()&#123;</span><br><span class="line">        this.callbacks = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$on</span>(name, fn)&#123;</span><br><span class="line">        this.callbacks[name] = this.callbacks[name] || []</span><br><span class="line">        this.callbacks[name].push(fn)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$emit</span>(name, args)&#123;</span><br><span class="line">        <span class="keyword">if</span>(this.callbacks[name])&#123;</span><br><span class="line">            this.callbacks[name].forEach(cb =&gt; cb(args))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># main.js</span></span><br><span class="line">Vue.prototype.<span class="variable">$bus</span> = new Bus()</span><br><span class="line"><span class="comment"># child1</span></span><br><span class="line">this.<span class="variable">$bus</span>.<span class="variable">$on</span>(<span class="string">'foo'</span>, handle)</span><br><span class="line"><span class="comment"># child2</span></span><br><span class="line">this.<span class="variable">$bus</span>.<span class="variable">$emit</span>(<span class="string">'foo'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>实践中可以使用Vue代替Bus类， 因为Vue已经实现了相应的功能</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新建一个Bus.js文件 写如下内容即可</span></span><br><span class="line">import Vue from <span class="string">'vue'</span></span><br><span class="line"><span class="built_in">export</span> default new Vue</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在组件中要导入Bus.js</span></span><br><span class="line"><span class="comment"># component1 </span></span><br><span class="line">import Bus from <span class="string">'Bus.js'</span></span><br><span class="line">Bus.<span class="variable">$on</span>(<span class="string">'foo'</span>, handle)</span><br><span class="line"></span><br><span class="line"><span class="comment"># component2</span></span><br><span class="line">import Bus from <span class="string">'Bus.js'</span></span><br><span class="line">Bus.<span class="variable">$emit</span>(<span class="string">'foo'</span>, <span class="string">'text'</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h3><p>插槽语法是Vue 实现的内容分发 API,用于复合组件开发。该技术在通用组件库开发中有大量应用。</p>
<ul>
<li><p>匿名插槽</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># component</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="comment"># parent</span></span><br><span class="line"><span class="comment"># hello world 会插入slot元素所在的位置</span></span><br><span class="line">&lt;component&gt; hello world&lt;/component&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>具名插槽<br>将内容分发到子组件的指定位置 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># component</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;slot name=<span class="string">"message"</span>&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># parent</span></span><br><span class="line">&lt;component&gt;</span><br><span class="line">    &lt;!-- 默认插槽使用 default 做参数 --&gt;</span><br><span class="line">    &lt;template v-slot:default&gt;具名插槽&lt;/template&gt;</span><br><span class="line">    &lt;template v-slot:message&gt;信息&lt;/template&gt;</span><br><span class="line">&lt;/component&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>作用域插槽<br>为了让插槽内容能够访问子组件中才有的数据时,就要使用作用域插槽.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  绑定在 &lt;slot&gt; 元素上的特性被称为插槽 prop。</span></span><br><span class="line"><span class="comment">#  现在在父级作用域中，我们可以给 v-slot 带一个值来定义我们提供的插槽 prop 的名字(slotProps),也可以自定义为其他的名字.</span></span><br><span class="line"><span class="comment"># child component</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;!-- 此处的foo 是 子组件中的数据, 通过绑定特性的方式传入 要分发的内容(component)中 --&gt;</span><br><span class="line">    &lt;slot :foo=<span class="string">"foo"</span>&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="comment"># parent </span></span><br><span class="line">&lt;childcom&gt;</span><br><span class="line">    &lt;!-- 把 v-slot的值指定为 作用域上下文对象 --&gt;</span><br><span class="line">    &lt;template v-slot:default=<span class="string">"slotProps"</span>&gt;</span><br><span class="line">        使用来自子组件数据: &#123;&#123; slotProps.foo &#125;&#125;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">&lt;/childcom&gt;</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/10/vue-component/" data-id="ckh44mzu400174sv2nuoew70f" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-build-with-hexo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/09/build-with-hexo/" class="article-date">
  <time datetime="2019-10-09T10:15:25.000Z" itemprop="datePublished">2019-10-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/09/build-with-hexo/">build-with-hexo</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本教程是如何使用hexo快速搭建一个个人博客！</p>
<h2 id="搭建工作环境"><a href="#搭建工作环境" class="headerlink" title="搭建工作环境"></a>搭建工作环境</h2><p>Hexo基于Node.js，搭建完整的工作环境需要先安装node，npm，git。</p>
<h2 id="全局安装Hexo"><a href="#全局安装Hexo" class="headerlink" title="全局安装Hexo"></a>全局安装Hexo</h2><p>Hexo是一个博客框架，Hexo官方提供了一个命令行工具，用于快速创建项目、页面、编译、部署博客，因此先安装Hexo的命令行工具（hexo-cli）。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<p>安装完之后，可能会出现 hexo 命令没有找到的错误，是因为还不能全局使用hexo命令，使用以下命令给hexo 建立软连接 ，之后就能使用hexo命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ln -s ~/npm-global/lib/node_modules/hexo-cli/bin/hexo /usr/<span class="built_in">local</span>/bin/hexo</span><br></pre></td></tr></table></figure>

<h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><p>新建文章页</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new <span class="string">'pageName'</span></span><br></pre></td></tr></table></figure>

<p>生成静态文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo generate</span><br><span class="line">hexo g</span><br></pre></td></tr></table></figure>

<p>启动server</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>

<p>将生成的静态文件部署到代码仓库的master分支上</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/10/09/build-with-hexo/" data-id="ckh44mztr000r4sv2zfh78wmn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/How-to-use-hexo-create-a-blog/">How to use hexo create a blog</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/5/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DOM/">DOM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/How-to-use-hexo-create-a-blog/">How to use hexo create a blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas-基础/">canvas 基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSS/" style="font-size: 20px;">CSS</a> <a href="/tags/DOM/" style="font-size: 10px;">DOM</a> <a href="/tags/How-to-use-hexo-create-a-blog/" style="font-size: 10px;">How to use hexo create a blog</a> <a href="/tags/canvas-基础/" style="font-size: 10px;">canvas 基础</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/10/09/DOM/">DOM</a>
          </li>
        
          <li>
            <a href="/2020/10/09/CSS总结/">CSS总结</a>
          </li>
        
          <li>
            <a href="/2020/10/09/canvas基础/">canvas</a>
          </li>
        
          <li>
            <a href="/2020/10/09/设计模式/">设计模式</a>
          </li>
        
          <li>
            <a href="/2020/10/09/重识CSS/">重识CSS</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Richard.Zhao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>